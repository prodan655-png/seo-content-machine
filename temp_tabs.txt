
    with tab5:
        st.subheader("üì§ –ï–∫—Å–ø–æ—Ä—Ç –ë—Ä–µ–Ω–¥-–±—É–∫—É")
        st.info("–ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –ø–æ–≤–Ω–∏–π –±—Ä–µ–Ω–¥-–±—É–∫ —É —Ñ–æ—Ä–º–∞—Ç—ñ HTML.")
        
        if st.button("üìÑ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –ë—Ä–µ–Ω–¥-–±—É–∫", type="primary"):
            with st.spinner("–ì–µ–Ω–µ—Ä—É—é –¥–æ–∫—É–º–µ–Ω—Ç..."):
                try:
                    # Gather data
                    brand_name = selected_project
                    
                    # Get ToV
                    tov_text = file_manager.read_file(selected_project, "tov.md")
                    
                    # Get Personas & CJM from config
                    import json
                    config_path = file_manager.get_project_path(selected_project) / "config.json"
                    personas_text = ""
                    cjm_text = ""
                    
                    if config_path.exists():
                        config = json.loads(config_path.read_text(encoding="utf-8"))
                        personas_text = config.get("audience", "")
                        cjm_text = config.get("cjm", "")
                    
                    # Generate HTML
                    from utils.report_generator import generate_brand_book_html
                    html_content = generate_brand_book_html(brand_name, tov_text, personas_text, cjm_text)
                    
                    # Offer download
                    st.success("‚úÖ –ë—Ä–µ–Ω–¥-–±—É–∫ —É—Å–ø—ñ—à–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ!")
                    st.download_button(
                        label="üíæ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ Brand Book (HTML)",
                        data=html_content,
                        file_name=f"BrandBook_{brand_name}.html",
                        mime="text/html"
                    )
                    
                except Exception as e:
                    st.error(f"–ü–æ–º–∏–ª–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó: {e}")

    with tab6:
        st.subheader("üìö –ë–∞–∑–∞ –ó–Ω–∞–Ω—å (Sitemap)")
        st.info("–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∫–∞—Ä—Ç—É —Å–∞–π—Ç—É, —â–æ–± –®–Ü –∑–Ω–∞–≤ –ø—Ä–æ –≤–∞—à—ñ —ñ—Å–Ω—É—é—á—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —ñ –º—ñ–≥ —Ä–æ–±–∏—Ç–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—é –ø–µ—Ä–µ–ª—ñ–Ω–∫–æ–≤–∫—É.")
        
        sitemap_url = st.text_input("URL Sitemap.xml", placeholder="https://example.com/sitemap.xml")
        
        max_pages = 10000  # Full crawl
        
        if st.button("üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ Sitemap (Full)", type="primary"):
            if not sitemap_url:
                st.error("–í–≤–µ–¥—ñ—Ç—å URL!")
            else:
                with st.spinner("–°–∫–∞–Ω—É—é –∫–∞—Ä—Ç—É —Å–∞–π—Ç—É —É –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ–∫–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ (—Ü–µ –∑–∞–π–º–µ 1-2 —Ö–≤–∏–ª–∏–Ω–∏)..."):
                    try:
                        from utils.sitemap_parser import ingest_sitemap
                        
                        # 1. Parse Sitemap
                        st.info("–ó–±–∏—Ä–∞—é –≤—Å—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è —Ç–∞ —Å–∫–∞–Ω—É—é —Å—Ç–æ—Ä—ñ–Ω–∫–∏...")
                        
                        # Create a placeholder for progress
                        progress_bar = st.progress(0)
                        status_text = st.empty()
                        
                        # Run ingestion
                        df = ingest_sitemap(sitemap_url, max_pages=max_pages)
                        
                        progress_bar.progress(100)
                        status_text.text("–ì–æ—Ç–æ–≤–æ!")
                        
                        if df.empty:
                            st.error("–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∂–æ–¥–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏!")
                        else:
                            st.success(f"‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ {len(df)} —Å—Ç–æ—Ä—ñ–Ω–æ–∫!")
                            
                            # 2. Save to CSV
                            csv_path = file_manager.get_project_path(selected_project) / "pages.csv"
                            df.to_csv(csv_path, index=False, encoding='utf-8')
                            st.info(f"–ó–±–µ—Ä–µ–∂–µ–Ω–æ –≤: {csv_path}")
                            
                            # 3. Ingest into Vector DB
                            with st.spinner("–Ü–Ω–¥–µ–∫—Å—É—é –≤ –≤–µ–∫—Ç–æ—Ä–Ω—É –±–∞–∑—É –¥–∞–Ω–∏—Ö..."):
                                vector_db.ingest_pages(selected_project, df)
                            
                            st.success("üéâ –ë–∞–∑–∞ –∑–Ω–∞–Ω—å –æ–Ω–æ–≤–ª–µ–Ω–∞! –¢–µ–ø–µ—Ä –®–Ü –º–æ–∂–µ —Ä–æ–±–∏—Ç–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—é –ø–µ—Ä–µ–ª—ñ–Ω–∫–æ–≤–∫—É.")
                            
                            # Show preview
                            with st.expander("–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏"):
                                st.dataframe(df[['url', 'title']].head(20))
                    
                    except Exception as e:
                        st.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                        import traceback
                        st.code(traceback.format_exc())
